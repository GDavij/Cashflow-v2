<div class="w-screen rounded-sm flex flex-col items-center gap-6">
  <div class="w-full rounded-sm flex flex-grow-0 px-6 py-4 mb-2 sm:w-3/4">
    <app-button routerLink="/">Return</app-button>
  </div>

  <section class="flex flex-col bg-white-0 w-full sm:w-3/4 min-h-12 px-6 py-4 motion-preset-slide-down-lg flex-wrap">
    <section class="flex justify-between items-end flex-wrap gap-4">
      <div class="w-fit flex flex-col gap-2">
        <h1 class="text-3xl text-white-800 motion-preset-slide-left-lg motion-delay-200">Categories</h1>
        <div class="w-full motion-preset-slide-right-lg h-1 bg-primary-active motion-duration-700 motion-delay-200"></div>
        <h3 class="text-xl text-white-700 motion-preset-slide-left-lg motion-delay-200">Manage you finance boundaries
        </h3>
      </div>

      <div class="flex gap-2 sm:flex-row flex-col items-end w-full">
        <div class="flex flex-col motion-preset-slide-right-lg motion-delay-200 w-full">
          <span class="text-white-800">Categories</span>
          <button [cdkMenuTriggerFor]="menu"
            class="w-full border-2 rounded-md border-white-300 focus:border-primary-active shadow-inner flex text-nowrap px-4 py-2 min-w-44 h-10">{{
            currentCategory?.name ?? "No category found"}}</button>

          <ng-template #menu>
            <div
              class="bg-white-0 shadow-md flex flex-col min-w-44 gap-2 rounded-md translate-y-2 border-t border-t-white-50 motion-preset-slide-down-md p-2"
              cdkMenu>
              @if (categories.length > 0) {
              @for(category of categories; track category.id) {
              <button class="rounded-md p-2 border-2 border-white-50 hover:bg-white-100 transition-all font-semibold" cdkMenuItem
                (click)="viewCategory(category)">{{category.name}} -
                @if (category.active) {
                <span class="text-success py-2 px-1 rounded-md"> Active </span>
                } @else {
                <span class="text-error py-2 px-1 rounded-md"> Deactive </span>
                }
              </button>
              }
              } @else {
              <span>No Category Found</span>
              }
            </div>
          </ng-template>

        </div>
        <app-button class="w-full" (click)="editCurrentCategory()" *ngIf="currentCategory">Edit Category</app-button>

        <app-button class="w-full" routerLink="edit">
          Create Category
        </app-button>

      </div>
    </section>

    <section>
      @if (isLoadingCurrentCategory) {
      <div class="w-full h-96 flex justify-center items-center motion-preset-fade motion-duration-1000">
        <div class="w-12 h-12 border-4 border-t-4 border-gray-200 rounded-full animate-spin border-t-blue-500"></div>
      </div>
      }
      @else if (!isLoadingCurrentCategory && currentCategory) {
        <div class="flex flex-wrap min-h-72 py-4 gap-2">

          @if (hasContraint) {

            <div class="flex-1 bg-white-0 shadow-sm border-white-50 border rounded-md flex flex-col p-2 items-center">
              <h4 class="text-lg text-primary text-nowrap">{{ constraintTitle }}</h4>
              
              <span class="flex h-full w-full justify-center items-center text-xl text-white-700 text-nowrap">{{ constraint }}</span>
            </div>
          }

          <div class="flex-1 bg-white-0 shadow-sm border-white-50 border rounded-md flex flex-col p-2 items-center">
              <h4 class="text-lg text-primary text-nowrap"> Total Transactions Registered </h4>


              <span class="flex h-full w-full justify-center items-center text-xl text-white-700 text-nowrap">{{ currentCategory.totalTransactionsRegistered }}</span>
          </div>

        </div>
      } @else {
      <div class="w-full h-96 flex justify-center items-center motion-preset-fade motion-duration-1000">
        <span class="text-gray-500">No Category Selected</span>
      </div>
      }
    </section>
  </section>



</div>